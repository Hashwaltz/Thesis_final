{% extends 'payroll/admin/payroll_admin_base.html' %}
{% block title %}Admin â€“ Deductions{% endblock %}

{% block content %}
<section class="p-6 space-y-6 text-gray-200">

  <!-- ===== HEADER ===== -->
  <header class="flex items-center justify-between">
    <h1 class="text-2xl font-semibold text-emerald-400 flex items-center gap-3">
      <i class="fa-solid fa-scale-balanced text-3xl"></i>
      Deductions
    </h1>
    <a href="{{ url_for('payroll_admin.create_deduction') }}"
       class="px-4 py-2 rounded-lg bg-green-600 hover:bg-green-700 transition">
      Add Deduction
    </a>
  </header>

  <!-- ===== SEARCH ===== -->
  <form method="get" action="{{ url_for('payroll_admin.deductions') }}"
        class="bg-gray-800 p-5 rounded-2xl border border-gray-700 flex gap-2">
    <input type="text" name="search" value="{{ search }}" placeholder="Search deductions..."
           class="px-4 py-2 rounded-lg bg-gray-900 border border-gray-600 outline-none focus:ring-emerald-500"/>
    <button class="px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-700 transition">Search</button>
  </form>

  <!-- ===== DEDUCTION TABLE ===== -->
  <div class="overflow-x-auto bg-gray-800 rounded-2xl border border-gray-700 mt-4">
    <table class="min-w-full text-sm">
      <thead class="bg-gray-900 text-emerald-400">
        <tr>
          <th class="px-4 py-3 text-left">ID</th>
          <th class="px-4 py-3 text-left">Name</th>
          <th class="px-4 py-3 text-left">Actions</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-700">
        {% for deduction in deductions %}
        <tr class="hover:bg-gray-700/40 transition">
          <td class="px-4 py-3">{{ deduction.id }}</td>
          <td class="px-4 py-3">{{ deduction.name }}</td>
          <td class="px-4 py-3 flex gap-2">
            <a href="{{ url_for('payroll_admin.edit_deduction', deduction_id=deduction.id) }}"
               class="px-3 py-1 bg-blue-600 rounded hover:bg-blue-700 transition">Edit</a>

            <form action="{{ url_for('payroll_admin.delete_deduction', deduction_id=deduction.id) }}" method="POST"
                  onsubmit="return confirm('Are you sure you want to delete this deduction?');">
              <button type="submit" class="px-3 py-1 bg-red-600 rounded hover:bg-red-700 transition">Delete</button>
            </form>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="3" class="text-center py-6 text-gray-400">No deductions found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- ===== PAGINATION ===== -->
  <div class="flex justify-center items-center gap-4 mt-4">
    {% if pagination.has_prev %}
      <a class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600"
         href="{{ url_for('payroll_admin.deductions', page=pagination.prev_num, search=search) }}">
        Previous
      </a>
    {% endif %}
    <span class="text-gray-300">Page {{ pagination.page }} of {{ pagination.pages }}</span>
    {% if pagination.has_next %}
      <a class="px-4 py-2 bg-gray-700 rounded-lg hover:bg-gray-600"
         href="{{ url_for('payroll_admin.deductions', page=pagination.next_num, search=search) }}">
        Next
      </a>
    {% endif %}
  </div>

</section>
{% endblock %}
