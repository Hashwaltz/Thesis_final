<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Payroll Admin{% endblock %}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('payroll_admin.static', filename='img/favicon.avif') }}" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Heroicons CDN -->
    <script src="https://unpkg.com/heroicons@2.0.18/dist/outline.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('payroll_admin.static', filename='css/style2.css') }}" />
    <link rel="stylesheet" href="{{ url_for('payroll_admin.static', filename='css/forms.css') }}" />
  </head>

  <body class="bg-gray-900 text-gray-100 flex flex-col md:flex-row min-h-screen font-sans">

    <!-- Mobile Navbar -->
    <header class="md:hidden bg-green-800 text-white flex justify-between items-center p-4 shadow-md sticky top-0 z-20">
      <div class="flex items-center gap-2">
        <button id="mobileMenuBtn" class="text-white focus:outline-none">
          <!-- Heroicon menu -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
        <h1 class="font-semibold text-lg">GovHRPay Payroll</h1>
      </div>
      <button id="logoutBtnMobile" class="text-white">
        <!-- Heroicon logout -->
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
        </svg>
      </button>
    </header>

    <!-- Sidebar -->
    <aside
      id="sidebar"
      class="bg-gray-950 text-white w-64 sm:w-72 flex-shrink-0 fixed md:static inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition-transform duration-300 z-30 flex flex-col justify-between border-r border-gray-800 shadow-xl"
    >
      <div class="overflow-y-auto flex-grow">
        <!-- Logo -->
        <div class="flex items-center gap-3 px-6 py-5 border-b border-gray-800 sticky top-0 bg-gray-950 z-10">
          <img src="{{ url_for('payroll_admin.static', filename='img/logo2.avif') }}" alt="Logo" class="w-12 h-12 rounded-full object-cover" />
          <div>
            <h2 class="text-lg font-semibold text-green-400">GovHRPay</h2>
            <p class="text-sm text-gray-400">Payroll Admin</p>
            <p class="text-sm text-gray-300 mt-1">Welcome! <span class="font-medium">{{ current_user.first_name }} {{ current_user.last_name }}</span></p>
          </div>
        </div>

        <!-- Navigation -->
        <nav class="mt-4 px-4 text-gray-300">
          {% for section, links in {
            "Employee Payroll": [
              ("user-group", "Dashboard", "payroll_admin.payroll_dashboard"),
              ("credit-card", "View Payrolls", "payroll_admin.view_payrolls"),
              ("cash", "Process Payrolls", "payroll_admin.process_payroll"),
              ("users", "Employees", "payroll_admin.view_employees")
            ],
            "Payroll Management": [
              ("calendar-days", "Payroll Periods", "payroll_admin.view_payroll_periods"),
              ("clock", "Payroll History", "payroll_admin.payroll_history_dashboard")
            ],
            "Payslips": [
              ("document-text", "Generate Payslips", "payroll_admin.generate_payslips_by_period"),
              ("paper-airplane", "Distribute/View Payslips", "payroll_admin.view_payslips")
            ]
          }.items() %}
          <div class="mb-6">
            <h3 class="text-sm uppercase tracking-wider text-gray-500 mb-2">{{ section }}</h3>
            <ul class="space-y-2">
              {% for icon, text, url in links %}
              <li>
                <a href="{{ url_for(url) }}" class="flex items-center gap-3 p-2 rounded-lg hover:bg-green-700/40 transition">
                  <!-- Heroicon -->
                  <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <use href="#{{ icon }}"></use>
                  </svg>
                  {{ text }}
                </a>
              </li>
              {% endfor %}
            </ul>
          </div>
          {% endfor %}
        </nav>
      </div>

      <!-- Logout -->
      <div class="p-4 border-t border-gray-800">
        <button id="logoutBtn" class="flex items-center gap-2 w-full justify-center py-2 rounded-lg bg-green-600 hover:bg-green-700 transition">
          <!-- Heroicon logout -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"/>
          </svg>
          Logout
        </button>
      </div>
    </aside>

    <!-- Overlay -->
    <div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-20 hidden md:hidden"></div>

    <!-- Main Content -->
    <main class="flex-1 p-4 sm:p-6 md:p-8 overflow-y-auto bg-gray-900">
      <div class="bg-green-800 text-white rounded-lg p-4 mb-6 flex flex-wrap gap-3 items-center justify-between shadow-md sticky top-0 z-10 hidden md:flex">
        <div class="flex items-center gap-3">
          <!-- Heroicon money -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 1.343-3 3v4c0 1.657 1.343 3 3 3s3-1.343 3-3v-4c0-1.657-1.343-3-3-3z"/>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v2m0 14v2m8-8h-2m-14 0H3"/>
          </svg>
          <h1 class="text-lg font-semibold">Payroll Management System</h1>
        </div>
      </div>

      {% block content %}{% endblock %}
    </main>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");
      const mobileMenuBtn = document.getElementById("mobileMenuBtn");

      mobileMenuBtn?.addEventListener("click", () => {
        sidebar.classList.toggle("-translate-x-full");
        overlay.classList.toggle("hidden");
      });

      overlay?.addEventListener("click", () => {
        sidebar.classList.add("-translate-x-full");
        overlay.classList.add("hidden");
      });

      document.getElementById("logoutBtn")?.addEventListener("click", confirmLogout);
      document.getElementById("logoutBtnMobile")?.addEventListener("click", confirmLogout);

      function confirmLogout(e) {
        e.preventDefault();
        Swal.fire({
          title: "Are you sure?",
          text: "You will be logged out.",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#3085d6",
          cancelButtonColor: "#d33",
          confirmButtonText: "Yes, logout!",
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = "{{ url_for('payroll_auth.logout') }}";
          }
        });
      }
    </script>
  </body>
</html>
