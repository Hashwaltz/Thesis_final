{% extends 'hr/admin/admin_base.html' %}
{% block title %}Add Department | HR Admin{% endblock %}

{% block content %}
<main class="p-6 md:p-10 space-y-6 text-white">

  <!-- Page Header -->
  <header class="mb-6">
    <h1 class="text-3xl font-bold flex items-center gap-2">
      <i class="fa-solid fa-building"></i>
      <i class="fa-solid fa-plus text-blue-400"></i>
      Add Department
    </h1>
  </header>

  <!-- Department Form -->
  <section class="bg-gray-800 rounded-2xl p-6 shadow-lg max-w-3xl mx-auto">
    <h2 class="text-xl font-semibold mb-4">Department Details</h2>
    <form method="POST" class="space-y-6">

      <!-- Department Name -->
      <div class="flex flex-col">
        <label class="text-gray-300 mb-2 font-medium">Department Name <span class="text-red-500">*</span></label>
        <input type="text" name="name" placeholder="Enter department name" required
               class="bg-gray-900 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"/>
      </div>

      <!-- Description -->
      <div class="flex flex-col">
        <label class="text-gray-300 mb-2 font-medium">Description</label>
        <textarea name="description" rows="4" placeholder="Enter department description"
                  class="bg-gray-900 text-white rounded-lg px-4 py-2 resize-none focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>
      </div>

      <!-- Department Head -->
      <div class="flex flex-col">
        <label class="text-gray-300 mb-2 font-medium">Department Head</label>
        <select name="head_id" class="bg-gray-900 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
          <option value="">Select Department Head</option>
          {% for emp in employees %}
            <option value="{{ emp.id }}">{{ emp.get_full_name() }}{% if emp.position %} - {{ emp.position.name }}{% endif %}</option>
          {% endfor %}
        </select>
      </div>

      <!-- Submit Button -->
      <div class="flex justify-end">
        <button type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-xl flex items-center gap-2 transition">
          <i class="fa-solid fa-building"></i>
          <i class="fa-solid fa-plus"></i>
          Add Department
        </button>
      </div>

    </form>
  </section>
</main>

<!-- SweetAlert -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        {% if category == 'success' %}
          Swal.fire({
            icon: 'success',
            title: 'Success',
            text: '{{ message }}',
            showConfirmButton: false,
            timer: 2000,
            timerProgressBar: true,
            willClose: () => { window.location.href = "{{ url_for('hr_admin.view_departments') }}"; }
          });
        {% elif category == 'error' %}
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: '{{ message }}',
            confirmButtonColor: '#e74a3b'
          });
        {% endif %}
      {% endfor %}
    {% endif %}
  {% endwith %}
});
</script>
{% endblock %}
