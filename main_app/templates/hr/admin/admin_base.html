<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>{% block title %}HR Admin | GovHRPay{% endblock %}</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='img/favicon.avif') }}">

  <!-- Font Awesome 6 (ALL ICONS COME FROM HERE) -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    crossorigin="anonymous"
  />

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-gray-100 flex flex-col md:flex-row min-h-screen font-sans">

<!-- ================= MOBILE HEADER ================= -->
<header class="md:hidden bg-blue-800 text-white flex justify-between items-center p-4 shadow sticky top-0 z-30">
  <div class="flex items-center gap-3">
    <button id="mobileMenuBtn">
      <i class="fa-solid fa-bars text-2xl"></i>
    </button>
    <span class="font-semibold text-lg">GovHRPay</span>
  </div>
  <button id="logoutBtnMobile">
    <i class="fa-solid fa-right-from-bracket text-xl"></i>
  </button>
</header>

<!-- ================= SIDEBAR ================= -->
<aside
  id="sidebar"
  class="bg-gray-950 w-64 sm:w-72 fixed md:static inset-y-0 left-0 transform -translate-x-full md:translate-x-0 transition duration-300 z-40 flex flex-col border-r border-gray-800"
>

  <!-- Sidebar Header -->
  <div class="px-6 py-5 border-b border-gray-800 flex items-center gap-3">
    <img src="{{ url_for('static', filename='img/logo2.avif') }}" class="w-12 h-12 rounded-full">
    <div>
      <h2 class="text-lg font-semibold text-blue-400">GovHRPay</h2>
      <p class="text-xs text-gray-400">HR Administrator</p>
      <p class="text-sm mt-1">
        Welcome, <b>{{ current_user.get_full_name() }}</b>
      </p>
    </div>
  </div>

  <!-- ================= NAVIGATION ================= -->
  <nav class="flex-1 overflow-y-auto px-4 py-4 text-gray-300">

    {% set menu = {
      "Employee Management": [
        ("fa-gauge", "Dashboard", "hr_admin.hr_dashboard"),
        ("fa-users", "Employees", "hr_admin.view_employees"),
        ("fa-user-shield", "User Accounts", "hr_admin.view_users")
      ],
      "Attendance & Leave": [
        ("fa-calendar-check", "Attendance", "hr_admin.attendance"),
        ("fa-clock", "Add Attendance", "hr_admin.add_attendance"),
        ("fa-plane-departure", "Leave Requests", "hr_admin.view_leaves")
      ],
      "Organization": [
        ("fa-building", "Departments", "hr_admin.view_departments"),
        ("fa-circle-plus", "Add Department", "hr_admin.add_department"),
        ("fa-id-badge", "Positions", "hr_admin.view_positions"),
        ("fa-user-plus", "Add Position", "hr_admin.add_position")
      ],
      "Reports & Settings": [
        ("fa-chart-line", "Attendance Reports", "hr_admin.attendance_report"),
        ("fa-chart-pie", "Leave Reports", "hr_admin.leave_report"),
        ("fa-gear", "Account Settings", "hr_admin.profile")
      ]
    } %}

    {% for section, links in menu.items() %}
    <div class="mb-6">
      <h3 class="text-xs uppercase text-gray-500 mb-2 tracking-wider">
        {{ section }}
      </h3>

      <ul class="space-y-1">
        {% for icon, label, endpoint in links %}
        <li>
          <a
            href="{{ url_for(endpoint) }}"
            class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-blue-700/40 transition"
          >
            <i class="fa-solid {{ icon }} w-5 text-blue-400"></i>
            <span>{{ label }}</span>
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>
    {% endfor %}

  </nav>

  <!-- ================= LOGOUT ================= -->
  <div class="p-4 border-t border-gray-800">
    <button
      id="logoutBtn"
      class="w-full flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 py-2 rounded-lg transition"
    >
      <i class="fa-solid fa-right-from-bracket"></i>
      Logout
    </button>
  </div>

</aside>

<!-- OVERLAY -->
<div id="overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden md:hidden"></div>

<!-- ================= MAIN CONTENT ================= -->
<main class="flex-1 p-4 sm:p-6 md:p-8 overflow-y-auto">

  <div class="hidden md:flex items-center gap-3 bg-blue-800 text-white p-4 rounded-lg shadow mb-6 sticky top-0 z-20">
    <i class="fa-solid fa-user-tie text-xl"></i>
    <h1 class="text-lg font-semibold">Human Resource Management System</h1>
  </div>

  {% block content %}{% endblock %}
</main>

<!-- ================= SCRIPTS ================= -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("overlay");

  document.getElementById("mobileMenuBtn")?.addEventListener("click", () => {
    sidebar.classList.toggle("-translate-x-full");
    overlay.classList.toggle("hidden");
  });

  overlay?.addEventListener("click", () => {
    sidebar.classList.add("-translate-x-full");
    overlay.classList.add("hidden");
  });

  document.getElementById("logoutBtn")?.addEventListener("click", confirmLogout);
  document.getElementById("logoutBtnMobile")?.addEventListener("click", confirmLogout);

  function confirmLogout(e) {
    e.preventDefault();
    Swal.fire({
      title: "Logout?",
      text: "You will be logged out of the system.",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#2563eb",
      cancelButtonColor: "#dc2626",
      confirmButtonText: "Yes, logout"
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = "{{ url_for('hr_auth.logout') }}";
      }
    });
  }
</script>

</body>
</html>
