{% extends 'hr/officer/officer_base.html' %}
{% block title %}HR Officer - View Employee{% endblock %}

{% block content %}
<main class="p-4 md:p-6 space-y-6">

  <!-- Header -->
  <h1 class="text-2xl font-semibold text-blue-400 flex items-center gap-2">
    <i class="fa-solid fa-id-badge"></i>
    Employee Details & Leave Credits
  </h1>

  <!-- Employee Basic Info -->
  <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
    <h2 class="text-lg font-semibold text-blue-400 mb-4">Personal Information</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-200 text-base">
      <div><span class="font-semibold">Full Name:</span> {{ employee.get_full_name() }}</div>
      <div><span class="font-semibold">Email:</span> {{ employee.email }}</div>
      <div><span class="font-semibold">Phone:</span> {{ employee.phone or '-' }}</div>
      <div><span class="font-semibold">Department:</span> {{ employee.department.name if employee.department else '-' }}</div>
      <div><span class="font-semibold">Position:</span> {{ employee.position.name if employee.position else '-' }}</div>
      <div>
        <span class="font-semibold">Date Hired:</span>
        {{ employee.date_hired.strftime('%Y-%m-%d') if employee.date_hired else '-' }}
      </div>
      <div><span class="font-semibold">Address:</span> {{ employee.get_full_address() or '-' }}</div>
      <div><span class="font-semibold">Gender:</span> {{ employee.gender or '-' }}</div>
    </div>

    <!-- Length of Service -->
    <div class="mt-6 border-t border-gray-700 pt-4">
      <h3 class="text-md font-semibold text-blue-300 mb-2">Length of Service</h3>
      <div class="text-gray-200 text-base flex gap-6">
        {% set years, months, days = employee.get_working_duration().split(',') %}
        <div><span class="font-semibold text-blue-400">{{ years.strip() }}</span></div>
        <div><span class="font-semibold text-blue-400">{{ months.strip() }}</span></div>
        <div><span class="font-semibold text-blue-400">{{ days.strip() }}</span></div>
      </div>
    </div>
  </div>

  <!-- Leave Period Filter -->
  <form method="get"
        class="flex flex-col md:flex-row gap-4 bg-gray-800 p-4 rounded-2xl border border-gray-700">
    <div>
      <label class="text-gray-400">Start Date</label>
      <input type="date" name="start_date" value="{{ start_date }}"
             class="bg-gray-700 text-white rounded px-3 py-2">
    </div>
    <div>
      <label class="text-gray-400">End Date</label>
      <input type="date" name="end_date" value="{{ end_date }}"
             class="bg-gray-700 text-white rounded px-3 py-2">
    </div>
    <div class="flex items-end">
      <button class="bg-blue-500 hover:bg-blue-600 px-4 py-2 rounded-xl text-white">
        Apply
      </button>
    </div>
  </form>

  <!-- Leave Credits Table -->
  <div class="overflow-x-auto bg-gray-800 rounded-2xl border border-gray-700">
    <table class="min-w-full text-lg text-gray-200">
      <thead class="bg-gray-900">
        <tr>
          <th class="px-6 py-4 text-left text-gray-300">Particulars</th>
          <th class="px-6 py-4 text-center text-gray-300">Vacation Leave</th>
          <th class="px-6 py-4 text-center text-gray-300">Sick Leave</th>
          <th class="px-6 py-4 text-center text-gray-300">Total</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-700">
        {% for row in leave_table %}
        <tr class="hover:bg-gray-700 transition">
          <td class="px-6 py-4">
            {{ row.particulars }}

            {% if row.type == 'earned' %}
              <div class="text-sm text-gray-400">(Jan â€“ Dec {{ today.year }})</div>
            {% elif row.type == 'balance' %}
              <div class="text-sm text-gray-400">(as of {{ today.strftime('%B %d, %Y') }})</div>
            {% endif %}
          </td>

          <td class="px-6 py-4 text-center">{{ row.vacation }}</td>
          <td class="px-6 py-4 text-center">{{ row.sick }}</td>
          <td class="px-6 py-4 text-center font-bold text-blue-400">{{ row.total }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Additional Employee Info -->
  <div class="bg-gray-800 p-6 rounded-2xl border border-gray-700">
    <h2 class="text-lg font-semibold text-blue-400 mb-4">Additional Information</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-200 text-base">
      <div><span class="font-semibold">CS Eligibility:</span> {{ employee.cs_eligibility or '-' }}</div>
      <div><span class="font-semibold">Marital Status:</span> {{ employee.marital_status or '-' }}</div>
      <div><span class="font-semibold">Emergency Contact:</span> {{ employee.emergency_contact or '-' }}</div>
      <div><span class="font-semibold">Emergency Phone:</span> {{ employee.emergency_phone or '-' }}</div>
    </div>
  </div>

</main>
{% endblock %}
