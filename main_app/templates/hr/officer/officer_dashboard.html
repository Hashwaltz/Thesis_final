{% extends 'hr/officer/officer_base.html' %}
{% block title %}HR Officer - Dashboard{% endblock %}

{% block content %}
<div class="space-y-6">

  <!-- Info Cards -->
  <section class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
    <!-- Present Today -->
    <div class="bg-slate-800 rounded-2xl shadow-lg p-6 flex items-center gap-4">
      <div class="text-blue-400 text-4xl">
        <i class="fa-solid fa-circle-check"></i>
      </div>
      <div>
        <h2 class="text-3xl font-bold">{{ present_count }}</h2>
        <p class="text-slate-300">Present Today</p>
      </div>
    </div>

    <!-- Absent Today -->
    <div class="bg-slate-800 rounded-2xl shadow-lg p-6 flex items-center gap-4">
      <div class="text-red-400 text-4xl">
        <i class="fa-solid fa-circle-xmark"></i>
      </div>
      <div>
        <h2 class="text-3xl font-bold">{{ absent_count }}</h2>
        <p class="text-slate-300">Absent Today</p>
      </div>
    </div>

    <!-- Total Employees -->
    <div class="bg-slate-800 rounded-2xl shadow-lg p-6 flex items-center gap-4">
      <div class="text-yellow-400 text-4xl">
        <i class="fa-solid fa-users"></i>
      </div>
      <div>
        <h2 class="text-3xl font-bold">{{ total_users }}</h2>
        <p class="text-slate-300">Total Employees</p>
      </div>
    </div>
  </section>

  <!-- Monthly Attendance Chart -->
  <section class="bg-slate-800 rounded-2xl shadow-lg p-6 h-96">
    <h2 class="text-lg font-semibold text-white mb-4">
      Monthly Attendance Overview - {{ current_month }} {{ current_year }}
    </h2>
    <canvas id="monthlyAttendanceChart" class="w-full h-full"></canvas>
  </section>

  <!-- Daily Reminders -->
  <section class="bg-slate-800 rounded-2xl shadow-lg p-6">
    <h2 class="text-lg font-semibold text-white mb-4">Daily Reminders</h2>
    {% if reminders %}
    <ul class="list-disc list-inside space-y-2 text-slate-300">
      {% for reminder in reminders %}
      <li class="flex items-center gap-2">
        <i class="fa-solid fa-bell text-blue-400"></i>
        <span>{{ reminder }}</span>
      </li>
      {% endfor %}
    </ul>
    {% else %}
    <p class="text-slate-400 text-center">No reminders for today!</p>
    {% endif %}
  </section>

</div>

<!-- Chart.js Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const monthlyDates = {{ monthly_dates | tojson }};
  const monthlyPresentCounts = {{ monthly_present_counts | tojson }};
  const monthlyAbsentCounts = {{ monthly_absent_counts | tojson }};
  const monthlyLateCounts = {{ monthly_late_counts | tojson }};

  const ctx = document.getElementById('monthlyAttendanceChart').getContext('2d');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: monthlyDates,
      datasets: [
        {
          label: 'Present',
          data: monthlyPresentCounts,
          backgroundColor: 'rgba(59, 130, 246, 0.3)', // Tailwind blue-500
          borderColor: 'rgba(59, 130, 246, 1)',
          borderWidth: 2,
          tension: 0.3,
          fill: true
        },
        {
          label: 'Absent',
          data: monthlyAbsentCounts,
          backgroundColor: 'rgba(220, 38, 38, 0.3)', // Tailwind red-600
          borderColor: 'rgba(220, 38, 38, 1)',
          borderWidth: 2,
          tension: 0.3,
          fill: true
        },
        {
          label: 'Late',
          data: monthlyLateCounts,
          backgroundColor: 'rgba(202, 138, 4, 0.3)', // Tailwind yellow-600
          borderColor: 'rgba(202, 138, 4, 1)',
          borderWidth: 2,
          tension: 0.3,
          fill: true
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: {
          title: { display: true, text: 'Date of Month', color: '#ccc' },
          ticks: { color: '#ccc' }
        },
        y: {
          beginAtZero: true,
          title: { display: true, text: 'Number of Employees', color: '#ccc' },
          ticks: { stepSize: 1, precision: 0, color: '#ccc' }
        }
      },
      plugins: {
        legend: { labels: { color: '#fff' } },
        tooltip: { mode: 'index', intersect: false },
        title: { display: false }
      }
    }
  });
});
</script>
{% endblock %}
