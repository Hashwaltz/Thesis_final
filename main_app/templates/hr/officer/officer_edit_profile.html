{% extends "hr/officer/officer_base.html" %}
{% block title %}HR Officer - Edit Password{% endblock %}

{% block content %}
<main class="p-6 flex justify-center items-start min-h-screen bg-gray-900">

  <div class="bg-gray-800 rounded-2xl shadow-xl w-full max-w-lg p-8 mt-10">
    <!-- Header -->
    <h1 class="text-2xl font-semibold text-blue-400 mb-6 text-center">
      <i class="fa-solid fa-key mr-2"></i> Change Password
    </h1>

    <!-- Form -->
    <form method="POST" action="{{ url_for('officer.edit_password') }}" id="editProfileForm" class="space-y-4">

      <!-- Email (readonly) -->
      <div>
        <label class="block text-gray-300 font-medium mb-1">Email</label>
        <input type="email" name="email" value="{{ current_user.email }}" readonly
               class="w-full px-4 py-2 rounded-lg bg-gray-700 text-gray-200 focus:ring-2 focus:ring-blue-400"/>
      </div>

      <!-- Password -->
      <div>
        <label class="block text-gray-300 font-medium mb-1">New Password</label>
        <input type="password" name="password" id="password" placeholder="Enter new password"
               class="w-full px-4 py-2 rounded-lg bg-gray-700 text-gray-200 placeholder-gray-400 focus:ring-2 focus:ring-blue-400"/>
      </div>

      <!-- Submit -->
      <div class="text-center">
        <button type="button" id="saveProfileBtn"
                class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-semibold transition">
          Update Password
        </button>
      </div>

    </form>
  </div>

</main>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const saveBtn = document.getElementById("saveProfileBtn");
  const form = document.getElementById("editProfileForm");

  // SweetAlert confirmation before submit
  saveBtn.addEventListener("click", function (e) {
    e.preventDefault();
    Swal.fire({
      title: "Do you want to save the new password?",
      showCancelButton: true,
      confirmButtonText: "Save",
      cancelButtonText: "Cancel",
      confirmButtonColor: "#4e73df",
      cancelButtonColor: "#858796",
    }).then((result) => {
      if (result.isConfirmed) {
        form.submit();
      }
    });
  });

  // Flash messages
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        Swal.fire({
          icon: "{{ 'success' if category == 'success' else 'warning' if category == 'warning' else 'info' }}",
          title: "{{ category|capitalize }}",
          text: "{{ message|safe }}",
          confirmButtonColor: "{{ '#4e73df' if category == 'success' else '#f0ad4e' }}"
        });
      {% endfor %}
    {% endif %}
  {% endwith %}
});
</script>
{% endblock %}
